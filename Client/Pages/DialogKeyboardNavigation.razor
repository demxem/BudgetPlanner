@inject Client.Services.ApiClient apiClient
@using Client.Models

<MudDialog>
    <DialogContent>
        <MudSelect T="YearModel" Label="Select Year" @Value="@_selectedYear" ValueChanged="(year => SetSelected(year))"
            AnchorOrigin="Origin.BottomCenter">
            @foreach (var year in YearsData)
            {
                <MudSelectItem Value="@year">@year.Name</MudSelectItem>
            }
        </MudSelect>
        <MudSelect T="string" Label="Months" @bind-Value="@_selectedMonth" AnchorOrigin="Origin.BottomCenter">
            <MudSelectItem Value="@("January")" />
            <MudSelectItem Value="@("February")" />
            <MudSelectItem Value="@("March")" />
            <MudSelectItem Value="@("April")" />
            <MudSelectItem Value="@("May")" />
            <MudSelectItem Value="@("June")" />
            <MudSelectItem Value="@("July")" />
            <MudSelectItem Value="@("August")" />
            <MudSelectItem Value="@("September")" />
            <MudSelectItem Value="@("October")" />
            <MudSelectItem Value="@("November")" />
            <MudSelectItem Value="@("Descember")" />
        </MudSelect>
    </DialogContent>
    <DialogActions>
        <MudButton OnClick=" Cancel">Cancel</MudButton>
        <MudButton Color="Color.Primary" OnClick="Submit">Ok</MudButton>
    </DialogActions>
</MudDialog>

@code {

    private string _selectedMonth = "";
    private YearModel _selectedYear;
    private string _inputYear = "";
    private int yearId;

    public IList<YearModel> YearsData = new List<YearModel>();
    public IList<MonthModel> IncomeData = new List<MonthModel>();

    [CascadingParameter] MudDialogInstance MudDialog { get; set; }

    protected override async void OnInitialized()
    {
        YearsData = await apiClient.GetYearsAsync();
    }
    public async Task GetIncomeByMonthAsync()
    {
        await apiClient.GetIncomeByMonthAsync();
    }
    public async Task AddIncomeByYearId()
    {
        MonthModel month = new MonthModel { Name = _selectedMonth, YearId = yearId };
        await apiClient.PostIncomeByYearIdAsync(month);
    }

    public void SetSelected(YearModel year)
    {
        yearId = year.Id;
    }

    void Submit()
    {
        AddIncomeByYearId();
        MudDialog.Close(DialogResult.Ok(true));
    }
    void Cancel() => MudDialog.Cancel();
}







